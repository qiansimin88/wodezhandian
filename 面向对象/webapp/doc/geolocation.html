<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="HandheldFriendly" content="true">
<meta name="MobileOptimized" content="320">
<title>Hello H5+</title>
<link rel="stylesheet" type="text/css" href="res/doc.css" charset="utf-8">
<link rel="stylesheet" type="text/css" href="res/prettify.sons.css" charset="utf-8">
<script type="text/javascript" src="res/doc.js" charset="utf-8"></script><script type="text/javascript" src="res/prettify.js" charset="utf-8"></script>
</head>
<body>
<header><div class="nvbt iback" onclick="back();"></div>
<div class="nvtt">Geolocation Document</div></header><div id="content" class="content">
<h1><a name="plus.geolocation">geolocation</a></h1>
<p>Geolocation模块管理设备位置信息，用于获取地理位置信息，如经度、纬度等。通过plus.geolocation可获取设备位置管理对象。虽然W3C已经提供标准API获取位置信息，但在某些平台存在差异或未实现，为了保持各平台的统一性，定义此规范接口获取位置信息。</p>
<h2>方法：</h2>
<ul>
<li>
<a href="#plus.geolocation.getCurrentPosition">getCurrentPosition</a>: 获取当前设备位置信息</li>
<li>
<a href="#plus.geolocation.watchPosition">watchPosition</a>: 监听设备位置变化信息</li>
<li>
<a href="#plus.geolocation.clearWatch">clearWatch</a>: 关闭监听设备位置信息</li>
</ul>
<h2>对象：</h2>
<ul>
<li>
<a href="#plus.geolocation.Position">Position</a>: JSON对象，设备位置信息数据</li>
<li>
<a href="#plus.geolocation.Coordinates">Coordinates</a>: JSON对象，地理坐标信息</li>
<li>
<a href="#plus.geolocation.PositionOption">PositionOption</a>: JSON对象，监听设备位置信息参数</li>
</ul>
<h2>回调方法：</h2>
<ul>
<li>
<a href="#plus.geolocation.GeolocationSuccessCallback">GeolocationSuccessCallback</a>: 获取设备位置信息成功的回调函数</li>
<li>
<a href="#plus.geolocation.GeolocationErrorCallback">GeolocationErrorCallback</a>: 获取设备位置信息失败的回调函数</li>
</ul>
<h2>权限：</h2>
<p>permissions</p>
<pre class="prettyprint linenums">
"Geolocation": {
	"description": "访问设备位置信息"
}
			</pre>
<h1><a name="plus.geolocation.getCurrentPosition">getCurrentPosition</a></h1>
<p>获取当前设备位置信息</p>
<pre class="prettyprint linenums">
void plus.geolocation.getCurrentPosition( successCB, errorCB, option );
				</pre>
<h2>说明：</h2>
<p class="des">位置信息将通过手机GPS设备或其它信息如IP地址、移动网络信号获取，由于获取位置信息可能需要较长的时间，当成功获取位置信息后将通过successCB回调函数返回。</p>
<h2>参数：</h2>
<ul>
<li>successCB: 
		<em>(
			<a href="#plus.geolocation.GeolocationSuccessCallback">GeolocationSuccessCallback</a>
			)
			必选 </em>获取设备位置信息成功回调函数<br>
</li>
<li>errorCB: 
		<em>(
			<a href="#plus.geolocation.GeolocationErrorCallback">GeolocationErrorCallback</a>
			)
			可选 </em>获取设备位置信息失败回调函数<br>
</li>
<li>option: 
		<em>(
			<a href="#plus.geolocation.PositionOption">PositionOption</a>
			)
			可选 </em>获取设备位置信息的参数<br>
</li>
</ul>
<h2>返回值：</h2>
<a href="#void">void</a>
			: 无<h2>平台支持：</h2>
<ul>
<li>Android2.2+ (支持): 支持</li>
<li>iOS4.3+ (支持): 支持</li>
<li>WP7.5+ (支持): 暂不支持</li>
</ul>
<h2>示例：</h2>
<pre class="prettyprint linenums">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
	&lt;meta charset="utf-8"&gt;
	&lt;title&gt;Geolocation Example&lt;/title&gt;
	&lt;script type="text/javascript" &gt;
// 扩展API加载完毕后调用onPlusReady回调函数 
document.addEventListener( "plusready", onPlusReady, false );
// 扩展API加载完毕，现在可以正常调用扩展API
function onPlusReady() {
	plus.geolocation.getCurrentPosition( function ( p ) {
		alert( "Geolocation\nLatitude:" + p.coords.latitude + "\nLongitude:" + p.coords.longitude + "\nAltitude:" + p.coords.altitude );
	}, function ( e ) {
		alert( "Geolocation error: " + e.message );
	} );
}
	&lt;/script&gt;
	&lt;/head&gt;
	&lt;body &gt;
	&lt;/body&gt;
&lt;/html&gt;
				</pre>
<h1><a name="plus.geolocation.watchPosition">watchPosition</a></h1>
<p>监听设备位置变化信息</p>
<pre class="prettyprint linenums">
Number plus.geolocation.watchPosition( successCB, errorCB, option );
				</pre>
<h2>说明：</h2>
<p class="des">位置信息将通过手机GPS设备或其它信息如IP地址、移动网络信号获取。当位置信息更新后将通过successCB回调函数返回。位置信息获取失败则调用回调函数errorCB。</p>
<h2>参数：</h2>
<ul>
<li>successCB: 
		<em>(
			<a href="#plus.geolocation.GeolocationSuccessCallback">GeolocationSuccessCallback</a>
			)
			必选 </em><br>设备位置信息更新成功回调函数</li>
<li>errorCB: 
		<em>(
			<a href="#plus.geolocation.GeolocationErrorCallback">GeolocationErrorCallback</a>
			)
			可选 </em><br>获取设备位置信息失败回调函数</li>
<li>option: 
		<em>(
			<a href="#plus.geolocation.PositionOption">PositionOption</a>
			)
			可选 </em><br>监听设备位置信息的参数</li>
</ul>
<h2>返回值：</h2>
<a href="#Number">Number</a>
			: 用于标识位置信息监听器，可通过clearWatch方法取消监听。<h2>平台支持：</h2>
<ul>
<li>Android2.2+ (支持): 支持</li>
<li>iOS4.3+ (支持): 支持</li>
<li>WP7.5+ (支持): 暂不支持</li>
</ul>
<h2>示例：</h2>
<pre class="prettyprint linenums">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
	&lt;meta charset="utf-8"&gt;
	&lt;title&gt;Geolocation Example&lt;/title&gt;
	&lt;script type="text/javascript" &gt;
// 扩展API加载完毕后调用onPlusReady回调函数 
document.addEventListener( "plusready", onPlusReady, false );
// 扩展API加载完毕，现在可以正常调用扩展API
function onPlusReady() {
	plus.geolocation.watchPosition( function ( a ) {
			alert( "Geolocation\nLatitude:" + p.coords.latitude + "\nLongitude:" + p.coords.longitude + "\nAltitude:" + p.coords.altitude );
	}, function ( e ) {
		alert( "Geolocation error: " + e.message );
	} ); 
}
	&lt;/script&gt;
	&lt;/head&gt;
	&lt;body &gt;
	&lt;/body&gt;
&lt;/html&gt;
				</pre>
<h1><a name="plus.geolocation.clearWatch">clearWatch</a></h1>
<p>关闭监听设备位置信息</p>
<pre class="prettyprint linenums">
void plus.geolocation.clearWatch( watchId );
				</pre>
<h2>参数：</h2>
<ul><li>watchId: 
		<em>(
			<a href="#Number">Number</a>
			)
			必选 </em><br>需要取消的位置监听器标识，调用watchPosition方法的返回值。</li></ul>
<h2>返回值：</h2>
<a href="#void">void</a>
			: 无<h2>平台支持：</h2>
<ul>
<li>Android2.2+ (支持): 支持</li>
<li>iOS4.3+ (支持): 支持</li>
<li>WP7.5+ (支持): 暂不支持</li>
</ul>
<h2>示例：</h2>
<pre class="prettyprint linenums">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8"&gt;
		&lt;title&gt;Geolocation Example&lt;/title&gt;
		&lt;script type="text/javascript" &gt;
// 扩展API加载完毕后调用onPlusReady回调函数
document.addEventListener( "plusready", onPlusReady, false );
// 扩展API加载完毕，现在可以正常调用扩展API
var wid = null;
function onPlusReady() {
	plus.geolocation.getCurrentPosition( function ( p ) {
	alert( "Geolocation\nLatitude:" + p.coords.latitude + "\nLongitude:" + p.coords.longitude + "\nAltitude:" + p.coords.altitude );
	}, function ( e ) {
	alert( "Geolocation error: " + e.message );
	} );
}
function cancel() {
	plus.geolocation.clearWatch( wid );
	wid = null;
}
		&lt;/script&gt;
	&lt;/head&gt;
	&lt;body &gt;
		&lt;input type="button" value="Cancel" onclick="cancel();" &gt;&lt;/input&gt;
	&lt;/body&gt;
&lt;/html&gt;
				</pre>
<h1><a name="plus.geolocation.Position">Position</a></h1>
<p>JSON对象，设备位置信息数据</p>
<pre class="prettyprint linenums">
interface Position {
	readonly attribute Coordinates coords;
	readonly attribute DOMTimeStamp timestamp;
}
				</pre>
<h2>属性：</h2>
<ul>
<li>coords: <em>(<a href="#plus.geolocation.Coordinates">Coordinates</a>
	类型
)</em>地理坐标信息，包括经纬度、海拔、速度等信息<br>
</li>
<li>timestamp: <em>(<a href="#DOMTimeStamp">DOMTimeStamp</a>
	类型
)</em>获取到地理坐标的时间戳信息<br>
</li>
</ul>
<h1><a name="plus.geolocation.Coordinates">Coordinates</a></h1>
<p>JSON对象，地理坐标信息</p>
<pre class="prettyprint linenums">
interface Coordinates {
	readonly attribute double latitude;
	readonly attribute double longitude;
	readonly attribute double altitude;
	readonly attribute double accuracy;
	readonly attribute double altitudeAccuracy;
	readonly attribute double heading;
	readonly attribute double speed;
}			
				</pre>
<h2>属性：</h2>
<ul>
<li>latitude: <em>(<a href="#Number">Number</a>
	类型
)</em>坐标纬度值<br><p>数据类型对象，地理坐标中的纬度值。</p>
</li>
<li>longitude: <em>(<a href="#Number">Number</a>
	类型
)</em>坐标经度值<br><p>数据类型对象，地理坐标中的经度值。</p>
</li>
<li>altitude: <em>(<a href="#Number">Number</a>
	类型
)</em>海拔信息<br><p>数据类型对象，如果无法获取此信息，则此值为空（null）。</p>
</li>
<li>accuracy: <em>(<a href="#Number">Number</a>
	类型
)</em>地理坐标信息的精确度信息<br><p>数据类型对象，单位为米，其有效值必须大于0。</p>
</li>
<li>altitudeAccuracy: <em>(<a href="#Number">Number</a>
	类型
)</em>海拔的精确度信息<br><p>数据类型对象，单位为米，其有效值必须大于0。如果无法获取海拔信息，则此值为空（null）。</p>
</li>
<li>heading: <em>(<a href="#Number">Number</a>
	类型
)</em>表示设备移动的方向<br><p>
	数据类型对象，范围为0到360，表示相对于正北方向的角度。如果无法获取此信息，则此值为空（null）。如果设备没有移动则此值为NaN。
						</p>
</li>
<li>speed: <em>(<a href="#Number">Number</a>
	类型
)</em>表示设备移动的速度<br><p>
	数据类型对象，单位为米每秒（m/s），其有效值必须大于0。如果无法获取速度信息，则此值为空（null）。
						</p>
</li>
</ul>
<h1><a name="plus.geolocation.PositionOption">PositionOption</a></h1>
<p>JSON对象，监听设备位置信息参数</p>
<h2>属性：</h2>
<ul>
<li>enableHighAccuracy: <em>(<a href="#Boolean">Boolean</a>
	类型
)</em>是否高精确度获取位置信息<br><p>高精度获取表示需要使用更多的系统资源，默认值为false。</p>
</li>
<li>timeout: <em>(<a href="#Number">Number</a>
	类型
)</em>获取位置信息的超时时间<br><p>单位为毫秒（ms），默认值为不超时。如果在指定的时间内没有获取到位置信息则触发错误回调函数。</p>
</li>
<li>maximumAge: <em>(<a href="#Number">Number</a>
	类型
)</em>获取位置信息的缓存时间<br><p>单位为毫秒（ms），默认值为0（立即更新获取）。如果设备缓存的位置信息超过指定的缓存时间，将重新更新位置信息后再返回。</p>
</li>
</ul>
<h1><a name="plus.geolocation.GeolocationSuccessCallback">GeolocationSuccessCallback</a></h1>
<p>获取设备位置信息成功的回调函数</p>
<pre class="prettyprint linenums">
void onSuccess( position ) {
	// Get Position code.
}
				</pre>
<h2>参数：</h2>
<ul><li>position: 
		<em>(
			<a href="#plus.geolocation.Position">Position</a>
			)
			必选 </em>设备的地理位置信息，参考Position<br>
</li></ul>
<h2>返回值：</h2>
<a href="#void">void</a>
			: 无<h1><a name="plus.geolocation.GeolocationErrorCallback">GeolocationErrorCallback</a></h1>
<p>获取设备位置信息失败的回调函数</p>
<pre class="prettyprint linenums">
void onError( error ) {
	// Handle error
}
				</pre>
<h2>参数：</h2>
<ul><li>error: 
		<em>(
			<a href="#DOMException">DOMException</a>
			)
			必选 </em>获取位置操作的错误信息<br>
</li></ul>
<h2>返回值：</h2>
<a href="#void">void</a>
			: 无</div>
</body>
</html>
